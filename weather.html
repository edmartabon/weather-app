<!DOCTYPE html>
<html>
<head>
	<title>Simple Weather App</title>
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link rel="stylesheet" href="/css/style.css">
</head>
<body>
<header>
	<nav class="navbar navbar-inverse">
	  <div class="container-fluid">
	    <div class="navbar-header">
	      <a class="navbar-brand">Simple Weather App</a>
	    </div>
	  </div>
	</nav>
</header>
<section>
	<div class="col-sm-6 col-sm-offset-3">
	  <div class="panel panel-default">
	    
	    <div class="panel-heading"><h4>Check your weather today.</h4></div>
	    <div class="panel-body">
	      	<div class="row">
	      		<div class="col-sm-6">
				    <div class="form-group">
				      <label for="sel1">Select type of search:</label>
				      <select class="form-control" id="action" name="action">
				      	<option value="Select">Select</option>
				        <option value="zipcode" class="zipcode zip">Zipcode</option>
				        <option value="q" class="q">City Name</option>
				        <option value="cityid" class="cityid id">City Id</option>
				        <option value="coordinate" class="coordinate lat lon">Coordinates</option>
				      </select>
				      <br>
				    </div>
			    </div>
			    <div class="col-sm-6 user-inputs">
			    	<div class="q hide">
			    		<form method="get" action="/api/weather">
			    			<div class="row">
			    				<div class="col-sm-8">
					    			<div class="form-group">
					    				<label for="sel1">Enter your city name:</label>
					    				<input type="text" name="q" class="form-control text-zip text-q">
					    			</div>
					    		</div>

					    		<div class="col-sm-2">
			    					<button type="submit" class="btn btn-primary submit-button">Find</button>
			    				</div>
			    			</div>
			    		</form>
			    	</div>

			    	<div class="zipcode zip hide">
			    		<form method="get" action="/api/weather">
			    			<div class="row">
			    				<div class="col-sm-8">
					    			<div class="form-group">
					    				<label for="sel1">Enter your zip code:</label>
					    				<input type="text" name="zipcode" class="form-control text-zip text-zipcode">
					    			</div>
					    		</div>

					    		<div class="col-sm-2">
			    					<button type="submit" class="btn btn-primary submit-button">Find</button>
			    				</div>
			    			</div>
			    		</form>
			    	</div>

			    	<div class="cityid id hide">
			    		<form method="get" action="/api/weather">
			    			<div class="row">
			    				<div class="col-sm-8">
					    			<div class="form-group">
					    				<label for="sel1">Enter your city id:</label>
					    				<input type="text" name="id" class="form-control text-id">
					    			</div>
				    			</div>
			    				<div class="col-sm-2">
			    					<button type="submit" class="btn btn-primary submit-button">Find</button>
			    				</div>
		    				</div>
			    		</form>
			    	</div>

			    	<div class="coordinate lat lon hide">
			    		<form method="get" action="/api/weather">
			    			<div class="row">
			    				<div class="col-sm-4">
			    					<div class="form-group">
					    				<label for="sel1">Latitude:</label>
					    				<input type="text" name="lat" class="form-control text-lat">
					    			</div>
			    				</div>

			    				<div class="col-sm-4">
			    					<div class="form-group">
					    				<label for="sel1">Longitude:</label>
					    				<input type="text" name="lon" class="form-control text-lon">
					    			</div>
			    				</div>

			    				<div class="col-sm-4">
			    					<button type="submit" class="btn btn-primary submit-button">Find</button>
			    				</div>
			    			</div>
			    			
			    		</form>
			    	</div>
			    </div>
		    </div>

		    <hr>
		    <div class="row">
			    <div class="row user-inputs">
			    	<div class="col-sm-12 zipcode zip hide col-sm-8 col-sm-offset-2">
			    		<h3>Zip code result:</h3>
			    	</div>

			    	<div class="col-sm-12 cityid id hide col-sm-8 col-sm-offset-2">
			    		<h3>City result:</h3>
			    	</div>

			    	<div class="col-sm-12 coordinate lat lon hide col-sm-8 col-sm-offset-2">
			    		<h3>Latitude and longitude result:</h3>
			    	</div>
			    </div>
		    
			    <ul class="list-group col-sm-8 col-sm-offset-2">
				  <li class="list-group-item result-city">
				  	<span class="glyphicon glyphicon-home" aria-hidden="true"></span> 
				  	<span class="content-text">City</span>
				  	<span class="pull-right">Manila</span>
			  	  </li>
			  	  <li class="list-group-item result-description">
				  	<span class="glyphicon glyphicon-asterisk" aria-hidden="true"></span> 
				  	<span class="content-text">Description</span>
				  	<span class="pull-right">clear sky</span>
			  	  </li>
			  	  <li class="list-group-item result-temperature">
				  	<span class="glyphicon glyphicon-fire" aria-hidden="true"></span> 
				  	<span class="content-text">Temperature</span>
				  	<span class="pull-right">285.514</span>
			  	  </li>
			  	  <li class="list-group-item result-humidity">
				  	<span class="glyphicon glyphicon-tint" aria-hidden="true"></span> 
				  	<span class="content-text">Humidity</span>
				  	<span class="pull-right">100</span>
			  	  </li>
			  	  <li class="list-group-item result-wind">
				  	<span class="glyphicon glyphicon-leaf" aria-hidden="true"></span> 
				  	<span class="content-text">Wind Speed</span>
				  	<span class="pull-right">5.52</span>
			  	  </li>

				</ul>
			</div>
	    </div>
	  </div>
	</div>
</section>
<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.js"></script>
<script type="text/javascript">
$(document).ready(function() {
	var weather = {{{ result }}};
	var result = {
	 	city: typeof weather.name !== 'undefined' ? weather.name : 'Unknown',
		description: typeof weather.weather !== 'undefined' && typeof weather.weather[0].description !== 'undefined' ? weather.weather[0].description : 'Unknown',
		temperature: typeof weather.main !== 'undefined' && typeof weather.main.temp !== 'undefined' ? weather.main.temp : 'Unknown',
		humidity: typeof weather.main !== 'undefined' && typeof weather.main.humidity !== 'undefined' ? weather.main.humidity : 'Unknown',
		wind: typeof weather.wind !== 'undefined' && typeof weather.wind.speed !== 'undefined' ? weather.wind.speed : 'Unknown',
	};

	var params = function() {
        function urldecode(str) {
            return decodeURIComponent((str+'').replace(/\+/g, '%20'));
        }

        function transformToAssocArray( prmstr ) {
            var params = {};
            var prmarr = prmstr.split("&");
            for ( var i = 0; i < prmarr.length; i++) {
                var tmparr = prmarr[i].split("=");
                params[tmparr[0]] = urldecode(tmparr[1]);
            }
            return params;
        }

        var prmstr = window.location.search.substr(1);
        return prmstr != null && prmstr != "" ? transformToAssocArray(prmstr) : {};
    }();

    $('.user-inputs > div').addClass('hide');

    $.each(['q', 'zipcode', 'cityid', 'id', 'lat', 'lon', 'coordinate'], function(key, value) {
    	if (typeof params[value] !== 'undefined') {
    		$('.user-inputs .' + value).removeClass('hide');
    	}
    });

    $('#action').on('change', function() {
    	var selected = $('option:selected', this).val();
    	$('.user-inputs > div').addClass('hide');
    	$('.user-inputs .' + selected).removeClass('hide');
    });

    $.each(result, function(key, value) {
    	$('.list-group .result-' + key + ' .pull-right').text(value);
    });

    $.each(params, function(key, value) {
    	$('.user-inputs .text-' + key).val(value);
    	$('#action .' + key).prop('selected', true);
    });
});
</script>
</body>
</html>